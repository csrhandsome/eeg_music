<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 样式现在统一在外部CSS文件中管理 -->
    <title>音乐游戏可视化 - P5.js版</title>
    <!-- 引入 P5.js -->
    <script src="p5.min.js"></script>
    <!-- 引入独立的CSS文件 -->
    <link rel="stylesheet" href="styles/music_game_p5.css">
    <!-- 引入双层堆叠按钮样式 -->
    <link rel="stylesheet" href="styles/stacked-button.css">
    <!-- 引入背景样式 -->
    <link rel="stylesheet" href="styles/body_background.css">
    <!-- 引入背景增强脚本 -->
    <script src="scripts/background_enhancer.js"></script>
</head>
<body>
    <!-- 右侧音符弹出框容器 -->
    <div class="note-popup-container" id="note-popup-container">
        <!-- 音符框将通过JavaScript动态创建 -->
    </div>
    
    <!-- P5.js 画布容器 -->
    <div id="p5-canvas-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;"></div>
    
    <!-- 左上角控制按钮 -->
    <button  onclick="goBack()" title="返回主页" style="position: fixed; top: 20px; left: 20px; z-index: 1000; background: transparent; border: none; padding: 0;">
        <img src="assets/back.svg" alt="返回" />
    </button>
    <!-- 右上角控制按钮 -->
    <button  onclick="goToRecord()" title="录制" style="position: fixed; top: 20px; right: 20px; z-index: 1000; background: transparent; border: none; padding: 0;">
        <img src="assets/record.svg" alt="录制" />
    </button>
    
    <!-- 通用浮动控制栏 -->
    <div class="mobile-control-bar">
        <div class="stacked-button-container control-bar" id="button-group-container">
            <div class="stacked-button-bottom control-bar"></div>
            <div class="stacked-button-top control-bar">
                <div class="button-group-content">
                    <div class="action-button primary" onclick="toggleMobileStatus()" role="button" tabindex="0">
                        <img src="assets/music.svg" alt="音乐" style="width: 16px; height: 16px;" />
                        <span>开始播放</span>
                    </div>
                    <div class="action-button secondary" onclick="goToHistory()" role="button" tabindex="0">
                        <img src="assets/history.svg" alt="历史记录" style="width: 16px; height: 16px;" />
                        <span>历史记录</span>
                    </div>
                </div>
            </div>
        </div> 
    </div> 
    
    <!-- 移动端状态显示 - 简化长条 -->
    <div class="mobile-status-center" style="display: none;">
        <div class="status-card">
            <div class="status-content">
                <span class="status-label">连接状态:</span>
                <span id="mobile-status-text">连接中...</span>
                <span class="status-separator">|</span>
                <span class="status-label">Arduino数据:</span>
                <span id="mobile-arduino-data">音符:0 频率:0.0Hz</span>
            </div>
            <button class="close-status-btn" onclick="toggleMobileStatus()">×</button>
        </div>
    </div>
       
    <!-- 输入面板 -->
    <div class="mobile-input-panel">
        <div class="panel-header">
            <h3 class="panel-title">🎵 输入歌曲名称</h3>
            <button class="close-btn" onclick="closeMobileInput()">×</button>
        </div>
        <input type="text" id="mobile-song-input" placeholder="请输入歌曲名称..." maxlength="100">
        <button onclick="sendMobileSongName()">确认发送</button>
    </div>
    
    <!-- 引入音游逻辑 -->
    <script src="music_game_p5.js"></script>
    <!-- 引入独立的JavaScript文件 -->
    <script src="scripts/music_game_p5_script.js"></script>
</body>
</html> 